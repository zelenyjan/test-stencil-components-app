import{r as l,c as s,h as i,H as h,g as c}from"./index-865d434c.js";import{c as m}from"./string.utils-f268fc6b-a0e9075c.js";import{F as o,a as u,b as d}from"./constants-2e8258cf-6d910b0d.js";import{v as r}from"./props-789f7529-a031cd01.js";import{t as g,h as n}from"./utils-c057a3fa-060e2c21.js";import{a as p}from"./template-10332292-dbb3a177.js";import"./sizes-6c5943b4-77be388d.js";import"./variants-2b936d58-0853e1f0.js";import"./gov.log-af905420-9e1fc599.js";const v='.gov-form-autocomplete__list{margin:0;padding:0}.gov-form-autocomplete__list>.gov-form-autocomplete__item{margin:0;padding:0;background:none}.gov-form-autocomplete__list>.gov-form-autocomplete__item::before{display:none}.gov-spin-animation,.gov-pseudo-spin-animation::before{animation:spin 4s linear infinite}@keyframes spin{100%{transform:rotate(360deg)}}@keyframes countdown{to{transform:scaleX(0)}}@keyframes progress{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}@keyframes pulse{0%{opacity:1}50%{opacity:0.4}100%{opacity:1}}.gov-form-autocomplete{position:relative;display:block;width:100%}.gov-form-autocomplete__list{font-weight:var(--gov-text-s-font-weight);font-size:var(--gov-text-s-font-size);line-height:var(--gov-text-s-line-height);letter-spacing:var(--gov-text-s-letter-spacing);position:absolute;top:100%;right:0;left:0;z-index:5;max-height:14.0625rem;margin-top:0.5rem;border:var(--gov-autocomplete-item-hover, 0.0625rem solid var(--gov-color-secondary-500));border-radius:var(--gov-border-radius, 0.1875rem);background:var(--gov-autocomplete-bg, var(--gov-color-neutral-white));overflow-x:hidden;overflow-y:auto;overscroll-behavior:none}.gov-form-autocomplete__list>.gov-form-autocomplete__item{padding:0.75rem 0.5rem;cursor:pointer}.gov-form-autocomplete__list:empty{display:none}.gov-form-autocomplete__item[aria-selected=""],.gov-form-autocomplete__item[aria-selected=true i],.gov-form-autocomplete__item[aria-selected="1"]{background:var(--gov-autocomplete-item-select, var(--gov-color-secondary-400))}@media not all and (pointer: coarse){.gov-form-autocomplete__item:hover{background:var(--gov-autocomplete-item-hover, var(--gov-color-primary-100))}}',f=class{constructor(t){l(this,t),this.govFocus=s(this,"gov-focus",7),this.govBlur=s(this,"gov-blur",7),this.govInput=s(this,"gov-input",7),this.govSelect=s(this,"gov-select",7),this.templateResolver=e=>e[this.nameKey],this.value="",this.identifier=void 0,this.variant=void 0,this.success=void 0,this.size="m",this.nameKey="name",this.name=void 0,this.required=!1,this.disabled=void 0,this.placeholder=void 0,this.readonly=void 0,this.invalid=void 0,this.minlength=2,this.maxlength=void 0,this.wcagDescribedBy=void 0,this.wcagLabelledBy=void 0,this.wcagOwns=void 0,this.focused=void 0,this.processing=!1,this.arrowCounter=-1,this.list=[],this.listBoxId=m("GovListBox")}validateVariant(t){r(u,t,o.root)}validateSize(t){r(d,t,o.root)}onArrowUp(){this.arrowCounter>0&&(this.arrowCounter=this.arrowCounter-1)}onArrowDown(){this.arrowCounter<this.list.length-1&&(this.arrowCounter=this.arrowCounter+1)}doSearch(){if(Number.isInteger(this.minlength)&&String(this.value).length<=this.minlength&&this.minlength){this.list=[],this.arrowCounter=-1,this.processing=!1;return}this.searchCallback&&(this.processing=!0,this.searchCallback(this.value).then(t=>this.list=t).catch(()=>this.list=[]).finally(()=>{this.arrowCounter=-1,this.processing=!1}))}componentWillLoad(){this.validateVariant(this.variant),this.validateSize(this.size)}render(){return i(h,{class:o.root,size:this.size,variant:this.variant},i("gov-form-input",{placeholder:this.placeholder,name:this.name,disabled:this.disabled,readonly:this.readonly,autocomplete:!1,size:this.size,variant:this.variant,required:this.required,invalid:this.invalid,role:"searchbox",value:this.value,minlength:this.minlength,maxlength:this.maxlength,"on-gov-input":g(this.onInputHandler.bind(this),200),"on-gov-keyup":this.onKeyUpHandler.bind(this),"on-gov-focus":this.onFocusHandler.bind(this),"on-gov-blur":this.onBlurHandler.bind(this),wcagAutocomplete:"list",wcagDescribedBy:this.wcagDescribedBy,wcagLabelledBy:this.wcagLabelledBy,wcagOwns:[this.listBoxId,this.wcagOwns].join(" "),wcagExpanded:this.list.length&&this.focused,ref:t=>this.inputRef=t},i("slot",{slot:"right-icon",name:"right-icon"})),i("ul",{class:o.list,role:"listbox",id:this.listBoxId},this.list.map((t,e)=>{const a=this.arrowCounter===e;return i("li",{class:o.item,innerHTML:this.templateResolver(t,a),role:"option","aria-posinset":e,tabindex:a?0:-1,"aria-setsize":this.list.length,onClick:()=>this.onSelectHandler(e),"aria-selected":p(a)})})))}onFocusHandler(t){this.focused=!0,this.arrowCounter=-1,(this.value||this.minlength===0)&&this.searchCallback&&this.doSearch(),t.stopPropagation(),this.govFocus.emit(t)}onBlurHandler(t){this.focused=!1,setTimeout(()=>this.list=[],200),this.arrowCounter=-1,t.stopPropagation(),this.govBlur.emit(t)}onInputHandler(t){this.value=t.target.value,t.stopPropagation(),this.govInput.emit(t),this.doSearch()}onSelectHandler(t=-1){let e=null;t>-1?e=this.list[t]:n(this.arrowCounter,this.list)&&(e=this.list[this.arrowCounter]),e&&(this.govSelect.emit(e),this.list=[],n(this.nameKey,e)&&typeof e[this.nameKey]=="string"&&(this.value=e[this.nameKey]))}onKeyUpHandler(t){const e=t.detail;t.stopPropagation(),e.keyCode===38?this.onArrowUp():e.keyCode===40?this.onArrowDown():e.keyCode===13&&this.onSelectHandler()}async setFocus(t){return this.inputRef.focus(t)}async clearValue(){this.value="",this.inputRef.value="",await this.inputRef.clearValue()}async setSearchCallback(t){this.searchCallback=t}async setTemplateResolver(t){this.templateResolver=t}get host(){return c(this)}static get watchers(){return{variant:["validateVariant"],size:["validateSize"]}}};f.style=v;export{f as gov_form_autocomplete};
