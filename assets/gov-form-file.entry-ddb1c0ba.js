import{r as v,c as s,h as a,H as h,g as c}from"./index-865d434c.js";import{c as d}from"./string.utils-f268fc6b-a0e9075c.js";import{g as p,t as n}from"./template-10332292-dbb3a177.js";import{a as m,b}from"./wcag-3792d4bb-39d8b903.js";import{c as _}from"./win-9c8460bb-918db7b8.js";import{d as u}from"./utils-c057a3fa-060e2c21.js";import{g as x}from"./form-669a7180-3dfc6c14.js";import"./sizes-6c5943b4-77be388d.js";import"./variants-2b936d58-0853e1f0.js";import"./constants-136d4cd3-0cf5de77.js";import"./constants-3df712e2-1aa85a1b.js";import"./constants-2e8258cf-6d910b0d.js";import"./constants-ebec7de8-f0e19892.js";import"./gov.log-af905420-9e1fc599.js";const r={root:"gov-form-file",area:"gov-form-file__area",label:"gov-form-file__label",input:"gov-form-file__input",list:"gov-form-file__list",item:"gov-form-file__item",attachments:"gov-form-file__attachments"};function g(e){const i=["bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let o=0,l=parseInt(e,10)||0;for(;l>=1024&&++o;)l=l/1024;return l.toFixed(l<10&&o>0?1:0)+" "+i[o]}function y(e,i){return typeof i=="string"&&i.length?i.replace(/\s/g,"").split(",").filter(o=>new RegExp(o.replace("*",".*")).test(e.type)).length>0:!0}function F(e,i){return Math.round(e.size/1024)<=i}const w='.gov-spin-animation,.gov-pseudo-spin-animation::before{animation:spin 4s linear infinite}@keyframes spin{100%{transform:rotate(360deg)}}@keyframes countdown{to{transform:scaleX(0)}}@keyframes progress{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}@keyframes pulse{0%{opacity:1}50%{opacity:0.4}100%{opacity:1}}.gov-form-file{position:relative;display:block;width:100%}.gov-form-file__label .gov-form-label__label>*:last-child{margin-bottom:0}.gov-form-file__input{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;opacity:0.0001;cursor:pointer}.gov-form-file__attachments{margin-top:1rem 0rem 0rem}.gov-form-file__item{display:flex;gap:1rem;align-items:center}.gov-form-file[disabled=""] .gov-form-file__label .gov-form-label__label,.gov-form-file[disabled=true i] .gov-form-file__label .gov-form-label__label,.gov-form-file[disabled="1"] .gov-form-file__label .gov-form-label__label{pointer-events:none}.gov-form-file[disabled=""] .gov-form-file__label .gov-form-label__label *,.gov-form-file[disabled=true i] .gov-form-file__label .gov-form-label__label *,.gov-form-file[disabled="1"] .gov-form-file__label .gov-form-label__label *{color:var(--gov-form-file-disabled-color, var(--gov-color-secondary-600))}.gov-form-file[expanded=""] .gov-form-file__area,.gov-form-file[expanded=true i] .gov-form-file__area,.gov-form-file[expanded="1"] .gov-form-file__area{position:relative;width:100%;padding:2rem 1.375rem 1.375rem;border:var(--gov-form-file-border, 0.0625rem dashed var(--gov-color-secondary-500));text-align:center;transition:background-color 150ms ease-in-out;will-change:background-color}.gov-form-file[expanded=""] .gov-form-file__area.highlight,.gov-form-file[expanded=true i] .gov-form-file__area.highlight,.gov-form-file[expanded="1"] .gov-form-file__area.highlight{background-color:var(--gov-color-primary-200)}.gov-form-file[expanded=""] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=true i] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded="1"] .gov-form-file__label .gov-form-label__label{width:100%;padding:1.375rem;border:var(--gov-form-file-border, 0.0625rem dashed var(--gov-color-secondary-500));text-align:center}.gov-form-file[expanded=""] .gov-form-file__attachments,.gov-form-file[expanded=true i] .gov-form-file__attachments,.gov-form-file[expanded="1"] .gov-form-file__attachments{margin:1.5rem 0rem 0rem}.gov-form-file[expanded=""][invalid=""] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=""][invalid=true i] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=""][invalid="1"] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=true i][invalid=""] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=true i][invalid=true i] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=true i][invalid="1"] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded="1"][invalid=""] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded="1"][invalid=true i] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded="1"][invalid="1"] .gov-form-file__label .gov-form-label__label{border-color:var(--gov-form-state-color-error, var(--gov-color-error))}@media (min-width: 30em){.gov-form-file[expanded=""] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded=true i] .gov-form-file__label .gov-form-label__label,.gov-form-file[expanded="1"] .gov-form-file__label .gov-form-label__label{padding:2rem}}',L=class{constructor(e){v(this,e),this.govFocus=s(this,"gov-focus",7),this.govBlur=s(this,"gov-blur",7),this.govFiles=s(this,"gov-files",7),this.govAddFile=s(this,"gov-add-file",7),this.govRemovFile=s(this,"gov-remove-file",7),this.expanded=!1,this.required=!1,this.disabled=void 0,this.displayAttachments=!0,this.name=void 0,this.accept=void 0,this.maxFileSize=-1,this.identifier=void 0,this.invalid=void 0,this.errorSize="Soubor je větší než povolená velikost {FILE_SIZE}",this.errorAccept="Soubor tohoto typu není povolen",this.attachmentsLabel="Přílohy",this.wcagDescribedBy=void 0,this.wcagLabelledBy=void 0,this.wcagRemoveLabel="Odebrat soubor {FILE_NAME}",this.wcagAttachmentsLabel="Přílohy",this.files=[],this.fileId=d("GovInputFile"),this.h=p(this.host),this.f=x(this.h)}registerListeners(){function e(){this.areaRef.classList.add("highlight")}function i(){this.areaRef.classList.remove("highlight")}if(this.inputRef.addEventListener("change",o=>{o.preventDefault(),o.stopPropagation();const l=o.target.files;this.validateFiles(l)},!1),this.expanded){const o=["dragover","dragleave"],l=["dragenter","dragover","mouseenter"],f=["dragleave","drop","mouseleave"];o.map(t=>this.inputRef.addEventListener(t,this.preventDefaults.bind(this),!1)),l.map(t=>this.inputRef.addEventListener(t,e.bind(this),!1)),f.forEach(t=>this.inputRef.addEventListener(t,i.bind(this),!1)),this.areaRef.addEventListener("drop",this.handleDrop.bind(this),!1)}}preventDefaults(e){e.preventDefault(),e.stopPropagation()}handleDrop(e){const i=e.dataTransfer;this.validateFiles(i.files)}validateFiles(e){Array.from(e).map(i=>{if((this.files.find(l=>l.file.name===i.name&&l.file.size===i.size)||null)===null){const l=typeof this.maxFileSize=="number"&&this.maxFileSize>0?F(i,this.maxFileSize):!0,f=y(i,this.accept),t={id:d("GovFormFile"),file:i,acceptValid:f,sizeValid:l};this.files=[...this.files,t],this.govAddFile.emit(t)}}),this.govFiles.emit(this.files)}componentWillLoad(){this.f.passAttrToControl("type","File"),this.f.passAttrToLabel("required",String(this.required))}async componentDidRender(){_()&&(await u(500),await this.validateWcag()),this.registerListeners()}render(){return a(h,{class:this.h.classes([r.root]),invalid:n(this.invalid),expanded:n(this.expanded)},a("div",{class:r.area,ref:e=>this.areaRef=e},a("slot",null),a("input",{class:r.input,ref:e=>this.inputRef=e,id:this.identifier||this.fileId,type:"file",name:this.name,accept:this.accept,onChange:this.onChangeHandler.bind(this),onFocus:this.onFocusHandler.bind(this),onBlur:this.onBlurHandler.bind(this),required:this.required,disabled:this.disabled,"aria-required":n(this.required),"aria-invalid":n(this.invalid),"aria-describedby":this.wcagDescribedBy,"aria-labelledby":this.wcagLabelledBy,"aria-disabled":n(this.disabled)})),this.h.hasSlot("attachments")?a("div",{class:r.attachments},a("slot",{name:"attachments"})):null,this.files.length&&this.displayAttachments?a("div",{class:r.attachments},a("gov-attachments",{label:this.wcagAttachmentsLabel,"wcag-label":this.wcagAttachmentsLabel},this.files.map(e=>a("gov-attachments-item",{"wcag-remove-labelled-by":e.id,"on-gov-remove":()=>this.onRemoveFileHandler(e)},a("span",{class:"sr-only",id:e.id},this.wcagRemoveLabel.replace("{FILE_NAME}",e.file.name)),e.file.name,e.acceptValid===!1?a("gov-form-message",{slot:"message",variant:"error"},a("gov-icon",{slot:"icon",name:"exclamation-triangle-fill"}),e.acceptValid===!1?this.errorAccept:null):null,e.sizeValid===!1?a("gov-form-message",{slot:"message",variant:"error"},a("gov-icon",{slot:"icon",name:"exclamation-triangle-fill"}),this.errorSize.replace("{FILE_SIZE}",g(this.maxFileSize*1024))):null,a("span",{slot:"info"},"(",g(e.file.size),")"))))):null)}onRemoveFileHandler(e){const i=this.files.findIndex(o=>o.id===e.id);if(i!==-1){const o=this.files,l=this.files[i];o.splice(i,1),this.files=[...o],this.govRemovFile.emit(l),this.govFiles.emit(this.files)}}onFocusHandler(e){e.stopPropagation(),this.govFocus.emit(e)}onBlurHandler(e){e.stopPropagation(),this.govBlur.emit(e)}onChangeHandler(e){e.stopPropagation()}async validateWcag(){m(this.wcagDescribedBy,"wcag-described-by",r.root),m(this.wcagLabelledBy,"wcag-labelled-by",r.root),b(this.identifier||this.fileId,this.wcagLabelledBy,r.root)}get host(){return c(this)}};L.style=w;export{L as gov_form_file};
